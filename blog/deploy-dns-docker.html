<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="A step-by-step guide on how to deploy an authoritative DNS server with Docker.">
    <title>Ghannam Aljabari</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="style.css" rel="stylesheet">
</head>

<body>
    <nav class="navbar navbar-expand-lg bg-body-tertiary">
        <div class="container-fluid">
            <a class="navbar-brand" href="#"></a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="../index.html">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Blog</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <div class="container">
        <h5>Deploy an Authoritative DNS Server with Docker</h5>
        <p>This guide will walk you through deploying an authoritative DNS server using Docker and BIND 9. We will create a bridge network and set up a DNS server, a web server, and a client to test the configuration.</p>
        
        <p>First, create a directory for the configuration files.</p>
        <pre>mkdir bind</pre>
        
        <p>Create the main BIND configuration file.</p>
        <pre>nano bind/named.conf</pre>
        <p>Add the following content:</p>
        <pre>options {
    directory "/var/cache/bind";
    listen-on { any; };
    listen-on-v6 { any; };
    allow-recursion { none; };
    allow-transfer { none; };
    allow-update { none; };
};

zone "example.com." {
    type primary;
    file "/etc/bind/db.example.com";
    notify explicit;
};</pre>

        <p>Create the zone file for your domain</code>. Replace <code>example.com</code> with your real domain name.</p>
        <pre>nano bind/db.example.com</pre>
        <p>Add the following content:</p>
        <pre>$TTL 86400
@   IN  SOA     example.com. admin.example.com. (
    2025071101 ; Serial
    3600       ; Refresh
    1800       ; Retry
    604800     ; Expire
    86400 )    ; Negative Cache TTL
@   IN  NS      ns1.example.com.
ns1 IN  A       192.168.10.10
@   IN  A       192.168.10.11
www IN  CNAME   example.com.</pre>

        <p>Create the <code>docker-compose.yml</code> file to define Docker containers.</p>
        <pre>nano docker-compose.yml</pre>
        <p>Add the following content:</p>
        <pre>networks:
  lab_network:
    driver: bridge
    ipam:
      config:
        - subnet: 192.168.10.0/24
          gateway: 192.168.10.1

services:
  dns-server:
    image: internetsystemsconsortium/bind9:9.20
    container_name: bind9
    restart: always
    ports:
      - "5353:53/tcp"
      - "5353:53/udp"
    networks:
      lab_network:
        ipv4_address: 192.168.10.10
    dns:
      - 192.168.10.10
    volumes:
      - ./bind:/etc/bind

  web-server:
    image: nginx
    container_name: nginx
    networks:
      lab_network:
        ipv4_address: 192.168.10.11
    dns:
      - 192.168.10.10

  client:
    image: alpine
    container_name: alpine
    networks:
      lab_network: {}
    dns:
      - 192.168.10.10
    tty: true
    stdin_open: true</pre>

        <p>Deploy the services using Docker Compose.</p>
        <pre>docker compose up -d</pre>
        <p>Access the client container to test DNS resolution.</p>
        <pre>docker exec -it alpine sh</pre>
        <p>Test DNS resolution for <code>example.com</code>.</p>
        <pre>nslookup example.com</pre>
        <p>Test web server access.</p>
        <pre>wget -O- http://example.com</pre>
        <p>This should return the Nginx welcome page.</p>
        <p>To clean up everything after you are done, use:</p>
        <pre>docker compose down</pre>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>